[[!meta title="Roadmap"]]

# 1.09

- Remove 1.08's "intent to remove" programs (unless any of them make sense as extensions)
- [[!template id=pr number=35]] FHS ([[!template id=issue number=2]])
  - split conf-qmail in to conf-qmail-bin, conf-qmail-queue, conf-qmail-man, etc.
  - `/var/qmail/DIR` unless `/var/qmail` not in `conf-qmail`
  - Configuration sugar: `./configure && make && make install` ([[!template id=issue number=9]])
- Debian (deb), RedHat (rpm), and /package packaging
  - [[!template id=pr number=76]] binary builds on openSUSE build service and locally
    - deb and rpm builds.  (was [[!template id=issue number=59]])
  - FHS-aware (default on): `/var/qmail` contains symlinks to FHS-compatible paths
  - FHS-strict (default off): `/var/qmail` does not exist
  - [[!template id=pr number=61]] Extract an "instqueue" program from instpackage.
  - [[!template id=issue number=91]]
- bugfixes
  - [[!template id=pr number=18]] qmail-remote: avoid recoding CRLF to CRCRLF
  - [[!template id=issue number=94]]
  - [[!template id=pr number=89]] Fix leap second handling on systems running TAI ([original patch](https://su.bze.ro/software/netqmail-1.05-TAI-leapsecs.patch))
  - [[!template id=pr number=90]] Improve Maildir file uniqueness in qmail-local.c ([original patch](https://su.bze.ro/software/qmail-1.03-maildir-uniq.patch))
  - Christopher K. Davis's [oversize DNS packet patch](https://github.com/notqmail/notqmail/compare/notqmail-dns-oversize)
  - [Sergio Gelato's fixed version of Andy Repton's outgoingip patch](http://qmailorg.schmonz.com/outgoingip.patch) to configure qmail-remote's IP in `control/outgoingip`
- code standardization
  - Refactor the C code, by replacing valid K&R (The C Programming Language first edition) constructs with valid C89 (ANSI, The C Programming Language second edition) constructs, when there is a C89 feature that supersedes a construct in K&R.  (e.g., function signatures, adding int type specifiers.)  Even when a K&R construct is legal in C89.
    - headers
      - [[!template id=pr number=65]] fix usage of most POSIX functions
    - types
      - [[!template id=pr number=70]] remove register storage class declaration from codebase.
      - [[!template id=pr number=84]] use ssize_t in substdio library.
  - Fix all compiler warnings generated by warning settings consistent with the codebase being legal C89, and possibly informed by later C standards, to include at least the default `conf-cc`.
    - correctness (undeclared function)
      - [[!template id=pr number=77]] use ANSI/C89 function signatures.
      - [[!template id=issue number=7]]
    - C89 v C99
      - [[!template id=issue number=7]]
  - [[!template id=issue number=48]]
- documentation modernization
  - [[!template id=pr number=36]] Append .md suffix to text docs. Adjust references.


# 1.9

## Use the latest DJB libraries

- Replace [stralloc](https://cr.yp.to/lib/stralloc.html) with [array](https://cr.yp.to/lib/array.html)
- Replace substdio with [buf](https://cr.yp.to/lib/buffer_get.html)[fer](https://cr.yp.to/lib/buffer_put.html)
- Replace time-handling code with [libtai](https://cr.yp.to/libtai/tai.html)
- Replace DNS resolver code with [djbdns's](https://cr.yp.to/djbdns/dns.html)
- [[!template id=issue number=88]] Use [mess822](https://cr.yp.to/mess822.html).
- Replace poll/select with [iopause](https://cr.yp.to/lib/iopause.html)
  - Possibly add kqueue and/or epoll support to iopause
- Replace exec (and related env_puts) with [pathexec](https://cr.yp.to/lib/pathexec.html)
- Update to latest [cdb](https://cr.yp.to/cdb/reading.html)
- Use [socket](https://cr.yp.to/lib/socket.html) for any remaining networking code that's still necessary

## Introduce new programming interfaces for use by extensions

- [Custom error strings for qmail-queue](https://notes.sagredo.eu/files/qmail/patches/qmail-queue-custom-error-v2.netqmail-1.05.patch)
- Extension interface
  - [[!template id=pr number=50]] This adds spawn-filter binary for filtering message passed to qmail-remote/qmail-local
- [Extension API for qmail-smtpd](http://qmail-spp.sourceforge.net)
- Tiny changes to qmail-smtpd for optionally running under a `qmail-popup`-alike SMTP AUTH parent program
- [Refactor `qmail-remote` to call an admin-configurable `tcpclient`](../wiki/Designs)
- Publish `qmail-popup`, `qmail-pop3d`, `qmail-qmtpd`, and `qmail-qmtpc` as extensions
- code standardization
  - Refactor the C code, by replacing valid K&R (The C Programming Language first edition) constructs with valid C89 (ANSI, The C Programming Language second edition) constructs, when there is a C89 feature that supersedes a construct in K&R.  (e.g., function signatures, adding int type specifiers.)  Even when a K&R construct is legal in C89.
    - headers
      - [[!template id=pr number=43]] cleanup: remove readwrite.h, use unistd.h instead.
      - [[!template id=pr number=44]] cleanup: remove exit.h, use unistd.h instead.
      - cleanup: remove fork.h, use unistd.h instead.


# 2.0

## queue-breaker release

- new build time defaults for on-disk queue
- add queue repair tool.
  - [[!template id=pr number=67]] remove qmail-upq
  - including the ability to upgrade a 1.x queue to 2.x in-place.
- merge big-todo (changes queue layout)
- increase default conf-split to 31 (changes queue layout)
- merge ext-todo
  - add a qmail-todo manpage, [[!template id=issue number=23]]
- merge netqmail-big-concurrency
- [qmail-ldap](http://www.nrg4u.com), or enough interfaces to let extensions provide LDAP integration
- make sure everything works with vmailmgr, vpopmail, other approaches to "virtual users"
- Merge changes for high-volume installations that are harmless defaults in 2020 (taking care to migrate smoothly)
- remove deprecated code
  - [[!template id=pr number=71]] remove install script.


# 2.1

## Port unmerged, blessed netqmail patches to the extension interface


# 2.2

## Extensions for postmaster interfaces

- Help developers adapt some code of theirs and get it merged


# 2.3

## Extensions for email clients

- Help developers convert more of their existing code to plugins


# 2.4

## Modernize Binc IMAP

- Get our hands on the original repo; else reconstitute as best we can
- Push the repo to a new notqmail-org project ("notbinc"? "ninb"?)
- Fix compile warnings
- How well does it handle huge maildirs?
- Fix how Maildir++ folders have to appear as subfolders of INBOX (by seeing how Dovecot manages)
    - Then remove IMAPdir support, unless there's some other reason to keep it
- Assuming it has unconstrained MIME recursion (@leahneukirchen's pet bug found in most mail software), constrain it
- Add UCSPI-TLS to `bincimap-up`
    - Then remove OpenSSL code
- Optionally reindex on message delivery (some sort of `qmail-local` integration)
- Maybe gradually refactor C++ to C
